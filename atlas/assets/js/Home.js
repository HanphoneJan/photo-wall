import{d as e,u as a,r as l,m as s,B as t,G as n,M as o,c as u,a as i,F as c,e as r,b as d,i as v,n as m,w as p,s as f,D as g,T as h,k,p as y,l as _,o as b,N as w,O as C,P as E,t as L,h as T,j as x,Q as z,z as A,R as j,v as q,S as B,U as G,V as I,W as N,X as V,Y as H,Z as R,_ as S,C as U,$ as Y}from"./index.js";import{a as F,E as P}from"./interceptor.js";const $={class:"sidebar-content"},D={class:"top-navigation"},M={class:"search-container"},O={key:0,class:"search-suggestions"},Q=["onClick"],W={class:"item-title"},X={class:"item-author"},Z={class:"tag-filter-section"},J={class:"tag-filter-header"},K={class:"filter-title"},ee={class:"tag-filter"},ae={class:"tags-container"},le={class:"sidebar-actions"},se=["src"],te=S(e({__name:"NavBar",setup(e){const S=a(),U=l("1"),Y=_(),te=n(),ne=l(!1),oe=l(""),ue=l([]),ie=l(!1),ce=l([]),re=l([]),de=l(!0),ve=l(!0);let me=null;const pe=()=>{null!==me&&clearTimeout(me),ve.value=!0,me=window.setTimeout((()=>{ie.value||(ve.value=!1)}),3e3)},fe=()=>{pe()},ge=()=>{ie.value=!ie.value,ie.value&&(ve.value=!0),pe()},he=()=>{ie.value=!1,pe()};s((()=>{const e=document.documentElement.classList;"dark"===S.theme?e.add("dark"):e.remove("dark")}));const ke={1:"/index",2:"/upload",3:"/blog",4:"/admin"},ye=e=>{const a=ke[e],l=a.slice(1);a?(Y.push(a),S.changePage(l),he()):console.warn(`没有找到路由: ${e}`),pe()},_e=()=>{Y.push("/login"),he(),pe()},be=()=>{Y.push("/profile"),he(),pe()},we=()=>{S.logout(),Y.push("/index"),he(),pe()},Ce=()=>{S.changeTheme("dark"===S.theme?"light":"dark"),pe()},Ee=async()=>{if(pe(),!oe.value.trim())return ue.value=[],void(ne.value=!1);ne.value=!0;try{ue.value=await Le(oe.value)}catch(e){console.error("搜索错误:",e.message),ue.value=[]}finally{ne.value=!1}},Le=async e=>{try{const a=await F.post(P.SEARCH,{query:e});return 830===a.data.status&&Array.isArray(a.data.data)?a.data.data:[]}catch(a){return console.error("获取图集数据失败:",a.message),[]}},Te=()=>{ne.value=!0,pe()};let xe;const ze=()=>{de.value=!de.value,pe()},Ae=()=>{const e={...te.query};re.value.length>0?e.tags=re.value.join(","):delete e.tags,Y.replace({query:e})};t((async()=>{(async()=>{try{const e=await F.get(P.GETTAG);830===e.data.status&&(ce.value=e.data.data)}catch(e){console.error("获取标签列表失败:",e.message)}})();const e=te.query.tags;e&&(re.value=e.split(",").map((e=>Number(e)))),pe(),document.addEventListener("mousemove",fe),document.addEventListener("keypress",fe),document.addEventListener("scroll",fe),document.addEventListener("touchstart",fe)})),o((()=>{null!==me&&clearTimeout(me),document.removeEventListener("mousemove",fe),document.removeEventListener("keypress",fe),document.removeEventListener("scroll",fe),document.removeEventListener("touchstart",fe)}));const je=u((()=>[...ce.value.filter((e=>re.value.includes(e.id))),...ce.value.filter((e=>!re.value.includes(e.id)))]));return(e,a)=>{const l=v("el-icon"),s=v("el-button"),t=v("el-input"),n=v("el-menu-item"),o=v("el-menu"),u=v("el-tag");return b(),i(c,null,[r(s,{class:m(["hamburger-button",{"hamburger-button-hidden":!ve.value}]),onClick:ge,circle:""},{default:p((()=>[r(l,{size:20},{default:p((()=>[ie.value?(b(),k(y(C),{key:1})):(b(),k(y(w),{key:0}))])),_:1})])),_:1},8,["class"]),d("div",{class:m(["sidebar",{"sidebar-open":ie.value}])},[d("div",$,[a[9]||(a[9]=d("div",{class:"studio-logo"},[d("span",{class:"logo-text"},"Hanphone"),d("span",{class:"logo-subtext"},"GALLERY")],-1)),d("div",D,[d("div",M,[r(l,{class:"search-icon",size:18},{default:p((()=>[r(y(E))])),_:1}),r(t,{onFocus:Te,onBlur:a[0]||(a[0]=e=>(clearTimeout(xe),xe=setTimeout((()=>{ne.value=!1,ue.value=[]}),200),void pe())),class:"search-input",placeholder:"搜索照片...",modelValue:oe.value,"onUpdate:modelValue":a[1]||(a[1]=e=>oe.value=e),onInput:Ee,size:"small",clearable:""},null,8,["modelValue"]),!ne.value&&ue.value.length?(b(),i("ul",O,[(b(!0),i(c,null,g(ue.value,(e=>(b(),i("li",{key:e.id,onClick:a=>{return l=e.path,window.location.href=l,ne.value=!1,ue.value=[],he(),void pe();var l},class:"search-item"},[d("span",W,L(e.title),1),d("span",X,"by "+L(e.author),1)],8,Q)))),128))])):f("",!0)]),r(o,{"default-active":U.value,class:"sidebar-menu",onSelect:ye,"background-color":"transparent"},{default:p((()=>[r(n,{index:"1"},{default:p((()=>[r(l,{slot:"icon",size:18},{default:p((()=>[r(y(z))])),_:1}),a[2]||(a[2]=x(" 照片墙 "))])),_:1}),r(n,{index:"2"},{default:p((()=>[r(l,{slot:"icon",size:18},{default:p((()=>[r(y(A))])),_:1}),a[3]||(a[3]=x(" 上传作品 "))])),_:1}),r(n,{index:"3"},{default:p((()=>[r(l,{slot:"icon",size:18},{default:p((()=>[r(y(j))])),_:1}),a[4]||(a[4]=x(" 我的博客 "))])),_:1}),T(r(n,{index:"4"},{default:p((()=>[r(l,{slot:"icon",size:18},{default:p((()=>[r(y(B))])),_:1}),a[5]||(a[5]=x(" 管理照片墙 "))])),_:1},512),[[q,y(S).isAdmin]])])),_:1},8,["default-active"]),d("div",Z,[d("div",J,[d("div",K,[r(l,null,{default:p((()=>[r(y(G))])),_:1}),a[6]||(a[6]=d("span",null,"筛选标签",-1))]),r(s,{class:m(["toggle-filter-btn",{active:de.value}]),onClick:ze,circle:""},{default:p((()=>[r(l,null,{default:p((()=>[de.value?(b(),k(y(I),{key:0})):(b(),k(y(N),{key:1}))])),_:1})])),_:1},8,["class"])]),r(h,{name:"slide-down"},{default:p((()=>[T(d("div",ee,[d("div",ae,[(b(!0),i(c,null,g(je.value,((e,a)=>(b(),k(u,{key:e.id,type:re.value.includes(e.id)?"primary":"info",size:"default",closable:re.value.includes(e.id),onClick:a=>{return l=e.id,re.value.includes(l)?re.value=re.value.filter((e=>e!==l)):re.value.push(l),Ae(),void pe();var l},onClose:e=>(e=>{re.value.splice(e,1),Ae(),pe()})(a),class:"tag-item",clearable:"false"},{default:p((()=>[x(L(e.name),1)])),_:2},1032,["type","closable","onClick","onClose"])))),128))])],512),[[q,de.value]])])),_:1})])]),d("div",le,[y(S).isLoggedIn?(b(),i(c,{key:1},[d("div",{class:"user-avatar",onClick:be},[y(S).avatar?(b(),i("img",{key:0,src:y(S).avatar,alt:"用户头像"},null,8,se)):(b(),k(l,{key:1},{default:p((()=>[r(y(V))])),_:1}))]),r(s,{class:"logout-button",onClick:we},{default:p((()=>a[8]||(a[8]=[x(" 退出 ")]))),_:1})],64)):(b(),k(s,{key:0,class:"login-button",onClick:_e},{default:p((()=>a[7]||(a[7]=[x(" 登录 ")]))),_:1})),r(s,{class:"theme-toggle-button",onClick:Ce,circle:""},{default:p((()=>[r(l,{size:18},{default:p((()=>["dark"===y(S).theme?(b(),k(y(H),{key:0})):(b(),k(y(R),{key:1}))])),_:1})])),_:1})])])],2),d("div",{class:m(["overlay",{"overlay-visible":ie.value}]),onClick:he},null,2)],64)}}}),[["__scopeId","data-v-208038fd"]]),ne=S(e({__name:"Home",setup(e){const s=l(0),n=l(!1);u((()=>a().pageName));const o=()=>{s.value=window.scrollY||document.documentElement.scrollTop||document.body.scrollTop};return U(s,(e=>{n.value=e>100})),t((()=>{window.addEventListener("scroll",o)})),Y((()=>{window.removeEventListener("scroll",o)})),(e,a)=>{const l=v("router-view"),s=v("el-main"),t=v("ArrowUpBold"),o=v("el-icon");return b(),i("div",null,[r(te),r(s,null,{default:p((()=>[r(l)])),_:1}),r(h,{name:"fade"},{default:p((()=>[n.value?(b(),i("p",{key:0,id:"back-top",onClick:a[0]||(a[0]=e=>{return a=0,void window.scrollTo({top:a,behavior:"smooth"});var a})},[d("span",null,[r(o,null,{default:p((()=>[r(t)])),_:1})])])):f("",!0)])),_:1})])}}}),[["__scopeId","data-v-b0294af9"]]);export{ne as default};
