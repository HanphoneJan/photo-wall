import{d as e,u as a,r as s,m as l,B as t,M as n,a as o,F as u,e as i,b as c,i as r,n as d,w as v,s as m,D as f,l as h,o as p,k as _,p as k,N as g,O as b,j as y,Q as z,a0 as E,a1 as x,z as w,P as L,t as C,a2 as A,Y as T,Z as j,_ as H}from"./index.js";import{a as I,E as N}from"./interceptor.js";const V={class:"sidebar-content"},B={class:"search-container"},D={key:0,class:"search-suggestions"},F=["onClick"],M={class:"item-title"},P={class:"item-author"},S={class:"sidebar-actions"},q=H(e({__name:"AdminNav",setup(e){const H=a(),q=s("1"),O=h(),Q=s(!1),R=s(""),U=s([]),Y=s(!1),Z=s(!0);let $=null;const G=()=>{null!==$&&clearTimeout($),Z.value=!0,$=window.setTimeout((()=>{Y.value||(Z.value=!1)}),3e3)},J=()=>{G()},K=()=>{Y.value=!Y.value,Y.value&&(Z.value=!0),G()},W=()=>{Y.value=!1,G()};l((()=>{const e=document.documentElement.classList;"dark"===H.theme?e.add("dark"):e.remove("dark")}));const X={1:"/admin/atlas",2:"/admin/tag",3:"/admin/user",4:"/index",5:"/upload"},ee=e=>{const a=X[e],s=a.slice(1);a?(O.push(a),H.changePage(s),W()):console.warn(`没有找到路由: ${e}`),G()},ae=()=>{H.logout(),O.push("/"),G()},se=()=>{H.changeTheme("dark"===H.theme?"light":"dark"),G()},le=async()=>{if(G(),!R.value.trim())return U.value=[],void(Q.value=!1);Q.value=!0;try{U.value=await te(R.value)}catch(e){console.error("搜索错误:",e.message),U.value=[]}finally{Q.value=!1}},te=async e=>{try{const a=await I.post(N.SEARCH,{query:e});return 830===a.data.status&&Array.isArray(a.data.data)?a.data.data:[]}catch(a){return console.error("获取图集数据失败:",a.message),[]}},ne=()=>{Q.value=!0,G()};let oe;return t((()=>{G(),document.addEventListener("mousemove",J),document.addEventListener("keypress",J),document.addEventListener("scroll",J),document.addEventListener("touchstart",J)})),n((()=>{null!==$&&clearTimeout($),document.removeEventListener("mousemove",J),document.removeEventListener("keypress",J),document.removeEventListener("scroll",J),document.removeEventListener("touchstart",J)})),(e,a)=>{const s=r("el-icon"),l=r("el-button"),t=r("el-menu-item"),n=r("el-menu"),h=r("el-input");return p(),o(u,null,[i(l,{class:d(["hamburger-button",{"hamburger-button-hidden":!Z.value}]),onClick:K,circle:""},{default:v((()=>[i(s,{size:20},{default:v((()=>[Y.value?(p(),_(k(b),{key:1})):(p(),_(k(g),{key:0}))])),_:1})])),_:1},8,["class"]),c("div",{class:d(["sidebar",{"sidebar-open":Y.value}])},[c("div",V,[a[7]||(a[7]=c("div",{class:"studio-logo"},[c("span",{class:"logo-text"},"Hanphone"),c("span",{class:"logo-subtext"},"ADMIN")],-1)),i(n,{"default-active":q.value,class:"sidebar-menu",onSelect:ee,"background-color":"transparent"},{default:v((()=>[i(t,{index:"1"},{default:v((()=>[i(s,{slot:"icon",size:18},{default:v((()=>[i(k(z))])),_:1}),a[2]||(a[2]=y(" 管理照片 "))])),_:1}),i(t,{index:"2"},{default:v((()=>[i(s,{slot:"icon",size:18},{default:v((()=>[i(k(E))])),_:1}),a[3]||(a[3]=y(" 管理标签 "))])),_:1}),i(t,{index:"3"},{default:v((()=>[i(s,{slot:"icon",size:18},{default:v((()=>[i(k(x))])),_:1}),a[4]||(a[4]=y(" 管理用户 "))])),_:1}),i(t,{index:"4"},{default:v((()=>[i(s,{slot:"icon",size:18},{default:v((()=>[i(k(z))])),_:1}),a[5]||(a[5]=y(" 照片墙 "))])),_:1}),i(t,{index:"5"},{default:v((()=>[i(s,{slot:"icon",size:18},{default:v((()=>[i(k(w))])),_:1}),a[6]||(a[6]=y(" 上传 "))])),_:1})])),_:1},8,["default-active"]),c("div",B,[i(s,{class:"search-icon",size:18},{default:v((()=>[i(k(L))])),_:1}),i(h,{onFocus:ne,onBlur:a[0]||(a[0]=e=>(clearTimeout(oe),oe=setTimeout((()=>{Q.value=!1,U.value=[]}),200),void G())),class:"search-input",placeholder:"搜索内容...",modelValue:R.value,"onUpdate:modelValue":a[1]||(a[1]=e=>R.value=e),onInput:le,size:"small",clearable:""},null,8,["modelValue"]),!Q.value&&U.value.length?(p(),o("ul",D,[(p(!0),o(u,null,f(U.value,(e=>(p(),o("li",{key:e.id,onClick:a=>{return s=e.path,window.location.href=s,Q.value=!1,U.value=[],W(),void G();var s},class:"search-item"},[c("span",M,C(e.title),1),c("span",P,"by "+C(e.author),1)],8,F)))),128))])):m("",!0)]),c("div",S,[i(l,{class:"logout-button",onClick:ae},{default:v((()=>[i(s,{size:16,class:"btn-icon"},{default:v((()=>[i(k(A))])),_:1})])),_:1}),i(l,{class:"theme-toggle-button",onClick:se,circle:""},{default:v((()=>[i(s,{size:18},{default:v((()=>["dark"===k(H).theme?(p(),_(k(T),{key:0})):(p(),_(k(j),{key:1}))])),_:1})])),_:1})])])],2),c("div",{class:d(["overlay",{"overlay-visible":Y.value}]),onClick:W},null,2)],64)}}}),[["__scopeId","data-v-3fe8fc5a"]]),O=e({__name:"AdminHome",setup:e=>(t((()=>{console.log("管理员界面挂载")})),(e,a)=>{const s=r("router-view"),l=r("el-main");return p(),o(u,null,[c("div",null,[i(q)]),i(l,null,{default:v((()=>[i(s)])),_:1})],64)})});export{O as default};
