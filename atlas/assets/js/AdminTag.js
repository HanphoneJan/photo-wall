import{d as a,r as e,c as l,B as t,a as s,e as o,w as n,i as u,E as r,o as d,a5 as i,b as c,p as m,P as f,x as p,F as v,D as y,k as g,j as _,a7 as w,a3 as x,t as b,a4 as k,_ as C}from"./index.js";import{a as h,E as T}from"./interceptor.js";const V={class:"admin-tag-container"},E={class:"op"},A={style:{color:"#3a8ee6"}},F={style:{"margin-bottom":"0"}},G={style:{color:"#2ac06d"}},j=C(a({__name:"AdminTag",setup(a){const C=e([]),j=e(!1),B=e(null),D=e({name:""}),I={name:[{required:!0,message:"标签名称不能为空",trigger:"blur"}]},L=e({id:null,name:""}),U=e(""),R=l((()=>{if(!U.value)return C.value;const a=U.value.toLowerCase();return C.value.filter((e=>e.name.toLowerCase().includes(a)))})),q=()=>{},K=async()=>{try{const{data:a}=await h.get(T.GETADMINTAG);830===a.status?(C.value=a.data,console.log("标签列表加载成功")):r.error("标签列表加载失败")}catch(a){console.error("获取标签列表失败:",a.message),r.error("获取标签列表失败，请稍后再试")}},M=async()=>{B.value&&B.value.validate((async a=>{if(!a)return;L.value.name=D.value.name;const{data:e}=await h.post(T.CREATETAG,{tag:L.value});830===e.status&&(j.value=!1,L.value.id=null,B.value.resetFields(),r.success("创建成功"),await K())}))},N=()=>{j.value=!1,D.value.name="",B.value?.resetFields()};return t(K),(a,e)=>{const l=u("el-input"),t=u("el-col"),C=u("el-icon"),P=u("el-button"),z=u("el-row"),H=u("el-card"),J=u("el-form-item"),O=u("el-form"),Q=u("el-dialog");return d(),s("div",V,[o(H,{shadow:"never"},{default:n((()=>[o(z,{gutter:10,class:"search-row"},{default:n((()=>[o(t,{xs:14,sm:16,md:18},{default:n((()=>[o(l,{placeholder:"请输入标签名称",modelValue:U.value,"onUpdate:modelValue":e[0]||(e[0]=a=>U.value=a),onKeyup:i(q,["enter"])},null,8,["modelValue"])])),_:1}),o(t,{xs:5,sm:4,md:3},{default:n((()=>[o(P,{type:"primary",onClick:q,class:"search-button"},{default:n((()=>[o(C,null,{default:n((()=>[o(m(f))])),_:1}),e[4]||(e[4]=c("span",{style:{"margin-left":"5px"}},"搜索",-1))])),_:1})])),_:1}),o(t,{xs:5,sm:4,md:3},{default:n((()=>[o(P,{type:"primary",onClick:e[1]||(e[1]=a=>j.value=!0),class:"create-button"},{default:n((()=>[o(C,null,{default:n((()=>[o(m(p))])),_:1}),e[5]||(e[5]=c("span",{style:{"margin-left":"5px"}},"新建",-1))])),_:1})])),_:1})])),_:1}),o(z,{gutter:20,style:{"margin-top":"20px"}},{default:n((()=>[(d(!0),s(v,null,y(R.value,(a=>(d(),g(t,{xs:24,sm:12,md:8,lg:6,key:a.id,class:"tag-col"},{default:n((()=>[o(H,{class:"atlas-card",shadow:"hover"},{default:n((()=>[c("div",E,[o(P,{onClick:e=>{return l=a.id,L.value.id=l,void(j.value=!0);var l},icon:m(w),style:{color:"#3a8ee6","margin-right":"5px"}},null,8,["onClick","icon"]),o(P,{onClick:e=>(async a=>{try{await k.confirm("此操作将永久删除该标签, 是否继续","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"});const{data:e}=await h.post(T.DELETETAG,{tagId:a});830===e.status&&await K()}catch{r.info("已取消删除")}})(a.id),icon:m(x),style:{color:"red"}},null,8,["onClick","icon"])]),c("b",null,[e[6]||(e[6]=_(" 标签名称 ")),c("span",A,b(a.name),1)]),e[8]||(e[8]=_()),e[9]||(e[9]=c("br",null,null,-1)),c("p",F,[e[7]||(e[7]=_("图片数量 ")),c("span",G,b(a.number),1)])])),_:2},1024)])),_:2},1024)))),128))])),_:1}),o(Q,{title:"修改标签",modelValue:j.value,"onUpdate:modelValue":e[3]||(e[3]=a=>j.value=a)},{footer:n((()=>[o(P,{onClick:N},{default:n((()=>e[10]||(e[10]=[_("取消")]))),_:1}),o(P,{type:"primary",onClick:M},{default:n((()=>e[11]||(e[11]=[_("提交")]))),_:1})])),default:n((()=>[o(O,{style:{"text-align":"left"},ref_key:"createTagFormRef",ref:B,model:D.value,rules:I,"label-width":"80px"},{default:n((()=>[o(J,{label:"标签名称",prop:"name"},{default:n((()=>[o(l,{modelValue:D.value.name,"onUpdate:modelValue":e[2]||(e[2]=a=>D.value.name=a)},null,8,["modelValue"])])),_:1})])),_:1},8,["model"])])),_:1},8,["modelValue"])])),_:1})])}}}),[["__scopeId","data-v-411faf50"]]);export{j as default};
